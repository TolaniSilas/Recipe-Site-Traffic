services:
  api:
    build:
      context: .
      dockerfile: app/api_dev/Dockerfile
    environment:
      FRONTEND_ORIGIN: "http://localhost:3000"  # change to real URL in prod
    volumes:
      - ./models:/app/models:ro
    ports:
      - "8000:8000"

  web:
    build:
      context: ./app/web_app
      dockerfile: Dockerfile
      args:
        # This is baked into the bundle
        REACT_APP_API_BASE_URL: "http://api:8000"
    environment:
      # CRA uses build-time env, but you can keep this for future config
      - NODE_ENV=production
    depends_on:
      - api
    ports:
      - "3000:80"